language: java
jdk: oraclejdk8

# Define the services to use
services:
  - docker

before_install:
  - sudo service mysql stop
  - docker pull takimatraining/devops-training-db
  - docker run -d -p 127.0.0.1:3306:3306 takimatraining/devops-training-db

# Run Unit Test and Integration Tests
script:
  - mvn verify

# Cache the .m2 folder to prevent redownloading dependencies on each build
cache:
  directories:
  - "$HOME/.m2/repository"

#Token:f8144bea99687c31a2324a9c827ed2aa4dd6dae6

env:
	global:
		- secure: "Fy4vHj5qDhSB741NiMEtU/NvCWJetvBZJTdntqT5hnekUiJzSeotVpbnlUnTk3yvAMmUi8mjPftakNWRpjUNGdPazCOVLkUA3UeMDfo0y+wGC+bEydJB2xH2FtVVr+Bs5dmatuRTsiVCXf0Psp6bqLgk/Iqn4+5AjnpwK8/qn9ha9F4yerAPIoUAsy3raDqjvGEYd6jU7PaATbL8d3QgAHKfK8NzJud7aqlAnOBomEPPjYyjxV9ED/CKDmFDuvaxWAoUKnSqgwp4W3sjwJhZO+8CANzMPVecuDFv4IGLUmohVGXTNJ+ojqwr+KYPRfrnaIou8rI3uTGRs6ZN1IZzRSalCpUgQEVXJKllR7hNG9D90mwqCX73qT950CqYT6tiiD+TmCDuy8T5NAEOHjKKAX+NHq5U736k4CeZFNY7ThI7eIAxcQmA1r1Mq/ohGxhDy3mxXliBzqCrb6FgEWNclqnarv2pGZMF13Dy6K2x7GGwlk1RppL5C99JBj4m+zFrZPoYUmdBMLCmSyA8Ft50pZ1SQLvbY1BcImmRRE+XDLahdoYKy0Fe/gXFUInpKUnpPSmVjnXgxlkXDx7mCEM3wt7s5L0zII20ydR59VJhD+1fBQRdXgoNrOyUKLg/bjjYLTweKbrmXuULD72ZE6czAPwbMgqN9jdigHAgjlU6yvA="

# The pipe (|) is useful to create multiline scripts
script:
  - |
    mvn clean install sonar:sonar \
    -Dsonar.projectKey=sample-application-students \
    -Dsonar.organization=ebonhomme01-github \
    -Dsonar.host.url=https://sonarcloud.io \
    -Dsonar.login=f8144bea99687c31a2324a9c827ed2aa4dd6dae6
